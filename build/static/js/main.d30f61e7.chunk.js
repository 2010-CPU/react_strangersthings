(this.webpackJsonpfolder_strangers_things=this.webpackJsonpfolder_strangers_things||[]).push([[0],{28:function(e,t,s){},35:function(e,t,s){},36:function(e,t,s){},37:function(e,t,s){"use strict";s.r(t);var n=s(0),r=s(4),a=s(1),c=s(20),o=s.n(c),i=s(3),u=s(10),j=(s(28),s(2)),p=s.n(j),l=s(6),h=function(e){var t=e.type,s=e.setToken,c=e.setUser,o=Object(a.useState)(""),j=Object(r.a)(o,2),h=j[0],d=j[1],b=Object(a.useState)(""),O=Object(r.a)(b,2),m=O[0],x=O[1],f="login"===t?"Login":"Register",g="login"===t?"Don't have an account?":"Already registered?",v="login"===t?"register":"login",k=Object(i.e)(),N=function(){var e=Object(l.a)(p.a.mark((function e(n){var r,a,o,i,u,j,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),console.log("username: ",h),console.log("password: ",m),e.next=5,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/users/".concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:h,password:m}})});case 5:return r=e.sent,e.next=8,r.json();case 8:if(a=e.sent,o=a.data,!(i=null===o||void 0===o?void 0:o.token)){e.next=26;break}return s(i),localStorage.setItem("token",i),e.next=16,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/users/me",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(i)}});case 16:return u=e.sent,e.next=19,u.json();case 19:j=e.sent,l=j.data,console.log("data:",l),c(l),d(""),x(""),k.push("/");case 26:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("div",{className:"login-container",children:[Object(n.jsx)("h2",{className:"login-title",children:f}),Object(n.jsxs)("form",{onSubmit:N,className:"signin-form",children:[Object(n.jsx)("input",{type:"text",value:h,onChange:function(e){return d(e.target.value)},placeholder:"username"}),Object(n.jsx)("input",{type:"password",value:m,onChange:function(e){return x(e.target.value)},placeholder:"password"}),Object(n.jsx)("button",{type:"submit",className:"button",children:f}),Object(n.jsx)(u.b,{to:"/".concat(v),className:"toggle-login",children:g})]})]})})},d=(s(35),function(e){var t=e.token,s=e.setToken,c=e.setUser,o=Object(a.useState)([]),i=Object(r.a)(o,2),u=i[0],j=i[1],h=function(){var e=Object(l.a)(p.a.mark((function e(){var n,r,a,c,o,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=12;break}return s(t),e.next=4,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/posts",{headers:{Authorization:"Bearer ".concat(t)}});case 4:return n=e.sent,e.next=7,n.json();case 7:r=e.sent,a=r.data.posts,j(a),e.next=20;break;case 12:return e.next=14,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/posts");case 14:return c=e.sent,e.next=17,c.json();case 17:o=e.sent,i=o.data.posts,j(i);case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){h()}),[]),Object(n.jsx)(n.Fragment,{children:u.map((function(e){var s=e.title,r=e.price,a=e.location,o=e.description,i=e._id,p=e.author,l=e.isAuthor;return Object(n.jsx)("div",{className:"post-container",children:Object(n.jsxs)("div",{className:"post",children:[Object(n.jsx)("div",{className:"post-title",children:s}),Object(n.jsxs)("div",{className:"post-description",children:["Description:  ",o]}),Object(n.jsxs)("div",{className:"price",children:["Price:  ",r]}),Object(n.jsxs)("div",{className:"location",children:["Location:  ",a]}),Object(n.jsxs)("div",{className:"seller",children:["Seller:  ",p.username]}),l?Object(n.jsx)(m,{token:t,postList:u,setPosts:j,postId:i}):"",t&&!l?Object(n.jsx)(f,{token:t,setUser:c,postId:i,setPosts:j}):""]})},i)}))})}),b=s(22),O=function(e){var t=e.token,s=Object(a.useState)([]),c=Object(r.a)(s,2),o=c[0],u=c[1],j=Object(a.useState)([]),h=Object(r.a)(j,2),d=h[0],O=h[1],m=Object(a.useState)([]),x=Object(r.a)(m,2),f=x[0],g=x[1],v=Object(a.useState)([]),k=Object(r.a)(v,2),N=k[0],y=k[1],P=Object(a.useState)(!1),S=Object(r.a)(P,2),T=S[0],C=S[1],U=Object(a.useState)([]),E=Object(r.a)(U,2),w=E[0],M=E[1],B=Object(i.e)(),R=function(){var e=Object(l.a)(p.a.mark((function e(){var s,n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/posts",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({post:{title:o,description:d,price:f,location:N,isAuthor:T}})});case 2:return s=e.sent,e.next=5,s.json();case 5:n=e.sent,r=n.data,u(""),O(""),g(""),y(""),C(!0),M([].concat(Object(b.a)(w),[r.post])),B.push("/users/me");case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=Object(l.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),R();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("div",{className:"add-post-container",children:[Object(n.jsx)("h3",{children:"Create your new post!"}),Object(n.jsxs)("form",{onSubmit:A,className:"add-post-form",children:[Object(n.jsx)("input",{type:"text",value:o,onChange:function(e){return u(e.target.value)},placeholder:"title"}),Object(n.jsx)("input",{type:"text",className:"description",value:d,onChange:function(e){return O(e.target.value)},placeholder:"description"}),Object(n.jsx)("input",{type:"text",value:f,onChange:function(e){return g(e.target.value)},placeholder:"price"}),Object(n.jsx)("input",{type:"text",value:N,onChange:function(e){return y(e.target.value)},placeholder:"location"}),Object(n.jsx)("button",{type:"submit",className:"button",children:"Submit"})]})]})})},m=function(e){var t=e.token,s=e.postId,r=e.setPosts,a=e.postList,c=function(){var e=Object(l.a)(p.a.mark((function e(n){var c,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/posts/".concat(n),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}});case 2:return c=e.sent,e.next=5,c.json();case 5:e.sent.success&&(o=a.filter((function(e){return e._id!==s})),r(o));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsx)(n.Fragment,{children:Object(n.jsx)("button",{className:"button-delete",onClick:function(){return c(s)},children:"DELETE"})})},x=function(e){var t=e.token,s=e.setUser,c=Object(a.useState)([]),o=Object(r.a)(c,2),i=o[0],u=o[1],j=function(){var e=Object(l.a)(p.a.mark((function e(){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/users/me",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}});case 2:return n=e.sent,e.next=5,n.json();case 5:r=e.sent,s(r.data.posts),u(r.data.posts);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){j()}),[t]),Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("div",{className:"your-posts",children:"Your Posts"}),i.map((function(e,s){var r=e.title,a=e.price,c=e.location,o=e.description,j=e._id,p=e.author;return Object(n.jsxs)("div",{className:"post-container",children:[Object(n.jsx)("div",{className:"post",children:Object(n.jsxs)("span",{className:"post-info",children:[Object(n.jsx)("div",{className:"post-title",children:r}),Object(n.jsxs)("div",{children:["Description:  ",o]}),Object(n.jsxs)("div",{children:["Price: ",a]}),Object(n.jsxs)("div",{children:["Location: ",c]}),Object(n.jsxs)("div",{children:["Seller: ",p.username]})]})}),Object(n.jsx)(m,{token:t,setPosts:u,postList:i,postId:j})]},s)}))]})},f=function(e){var t=e.token,s=e.postId,c=Object(a.useState)(""),o=Object(r.a)(c,2),i=o[0],u=o[1],j=function(){var e=Object(l.a)(p.a.mark((function e(n){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/posts/".concat(s,"/messages"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({message:{content:i}})});case 3:return r=e.sent,e.next=6,r.json();case 6:e.sent,u("");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("form",{onSubmit:j,className:"message-form",children:[Object(n.jsx)("input",{type:"text",className:"message-form-input",value:i,onChange:function(e){u(e.target.value)},placeholder:"Type message here"}),Object(n.jsx)("button",{className:"btn-message",type:"submit",children:"SEND MESSAGE"})]})})},g=function(e){var t=e.token,s=e.messages,r=e.setMessages,c=e.user,o=e.setUser,i=function(){var e=Object(l.a)(p.a.mark((function e(){var s,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("token:",t),e.next=3,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/users/me",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}});case 3:return s=e.sent,e.next=6,s.json();case 6:n=e.sent,r(n.data.messages),o(n.data.username);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){i()}),[t]),Object(n.jsx)(n.Fragment,{children:Object(n.jsx)("div",{className:"message-box",children:s.map((function(e,t){return e.fromUser.username!==c?Object(n.jsx)("div",{className:"messages-inbox-container",children:Object(n.jsxs)("div",{className:"messages-in",children:[Object(n.jsx)("h3",{children:"Message Inbox"}),Object(n.jsxs)("p",{children:["Re: ",e.post.title]}),Object(n.jsxs)("p",{children:["Message:",e.content]}),Object(n.jsxs)("p",{children:["From:",e.fromUser.username]})]})},t):Object(n.jsx)("div",{className:"messages-outbox-container",children:Object(n.jsxs)("div",{className:"messages-out",children:[Object(n.jsx)("h3",{children:"Message Outbox"}),Object(n.jsxs)("p",{children:["Re: ",e.post.title]}),Object(n.jsxs)("p",{children:["Message:",e.content]}),Object(n.jsxs)("p",{children:["From:",e.fromUser.username]})]})},t)}))})})},v=(s(36),function(e){var t=e.token,s=e.setToken,r=e.user,a=e.setUser;return Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("nav",{className:"nav-bar",children:[Object(n.jsx)("div",{id:"link-title",children:"Strangers Things"}),r.username&&Object(n.jsxs)("div",{className:"logged-in",children:["Hello ",r.username.toUpperCase(),"!"]}),Object(n.jsx)(u.b,{to:"users/me",className:"links",children:t?"User Profile":""}),Object(n.jsx)(u.b,{path:!0,to:"/messages",className:"links",children:t?"Messages":""}),Object(n.jsx)(u.b,{path:!0,to:"/addposts",className:"links",children:t?"Create Post":""}),Object(n.jsxs)(u.b,{to:"/login",onClick:function(){t&&(s(""),a({}))},className:"links",children:[t?"Logout":"Sign in","  "]}),"\xa0",Object(n.jsx)(u.b,{to:"/",className:"links",children:"Home"})]})})}),k=function(){var e=Object(a.useState)(""),t=Object(r.a)(e,2),s=t[0],c=t[1],o=Object(a.useState)({}),u=Object(r.a)(o,2),j=u[0],p=u[1],l=Object(a.useState)([]),b=Object(r.a)(l,2),m=b[0],f=b[1],k=Object(a.useState)([]),N=Object(r.a)(k,2),y=N[0],P=N[1];return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(v,{token:s,setToken:c,messages:y,setMessages:P,user:j,setUser:p}),Object(n.jsx)(i.a,{exact:!0,path:"/",children:Object(n.jsx)(d,{setPosts:f,posts:m,token:s,setToken:c})}),Object(n.jsx)(i.a,{path:"/register",children:Object(n.jsx)(h,{type:"register",setToken:c,token:s,setUser:p})}),Object(n.jsx)(i.a,{path:"/login",children:Object(n.jsx)(h,{type:"login",setToken:c,setUser:p})}),Object(n.jsx)(i.a,{path:"/addposts",children:Object(n.jsx)(O,{setPosts:f,token:s,posts:m,user:j,setUser:j})}),Object(n.jsx)(i.a,{path:"/users/me",children:Object(n.jsx)(x,{user:j,setUser:p,setPosts:f,token:s,posts:m,messages:y,setMessages:P})}),Object(n.jsx)(i.a,{path:"/messages",children:Object(n.jsx)(g,{token:s,setUser:p,user:j,messages:y,setMessages:P})})]})};o.a.render(Object(n.jsx)(u.a,{children:Object(n.jsx)(k,{})}),document.getElementById("app"))}},[[37,1,2]]]);
//# sourceMappingURL=main.d30f61e7.chunk.js.map